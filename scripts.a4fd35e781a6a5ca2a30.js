"use strict";var DEFAULT_LACK=16;function getRowNumbers(){for(var r=[],e=[1,2,3,4,5,6,7,8,9];e.length>1;){var t=Math.ceil(Math.random()*e.length)-1;r.push(e[t]),e.splice(t,1)}return r.push(e[0]),r}function checkLine(r,e,t){return t.every((function(t,n){for(var i=r-1;i>=0;i--)if(e[i][n]===t)return!1;for(var a=n%3,u=r%3,f=n-a;f<n-a+3;f++)for(var o=r-u;o<r;o++)if(e[o][f]===t)return!1;return!0}))}function getLastLine(r){for(var e=0,t=[];e<9;){var n=[1,2,3,4,5,6,7,8,9];r.forEach((function(r,t){var i=n.indexOf(r[e]);n.splice(i,1)})),e++,t.push(n[0])}return t}function getFull(){for(var r=[],e=0;e<8;e++){var t=getRowNumbers();if(0!==e){for(var n=1;!checkLine(e,r,t);)if(t=getRowNumbers(),++n>7e4)return getFull();r.push(t)}else r.push(t)}var i=getLastLine(r);return checkLine(8,r,i)?(r.push(i),r):getFull()}function blink(r){var e=getFull();for(r=r&&/^\d+$/.test(r)?r>64?DEFAULT_LACK:Math.abs(r):DEFAULT_LACK;r--;){for(var t=Math.ceil(81*Math.random())-1,n=Math.floor(t/9),i=t%9;0===e[n][i];)t=Math.ceil(81*Math.random())-1,n=Math.floor(t/9),i=t%9;e[n][i]=0}return e}function isRepeat(r){for(var e=0,t=r.length;e<t;e++)if(r.indexOf(r[e])!==r.lastIndexOf(r[e]))return!0;return!1}function checkMatrix(r){var e,t,n;for(e=0,t=r.length;e<t;e++){if(-1!==r[e].indexOf(0))return!1;if(isRepeat(r[e]))return{row:e}}for(var i=9;i--;)for(n=[],e=0;e<9;e++){if(!/^[1-9]$/.test(r[e][i]))return!1;if(-1!==n.indexOf(r[e][i]))return{column:i};n.push(r[e][i])}for(var a=0;a<3;a++)for(var u=0;u<3;u++){var f=3*a,o=3*u,c=[r[f][o],r[f][o+1],r[f][o+2],r[f+1][o],r[f+1][o+1],r[f+1][o+2],r[f+2][o],r[f+2][o+1],r[f+2][o+2]];if(-1!==c.indexOf(0))return!1;if(isRepeat(c))return{block:[a,u]}}return!0}module.exports={matrix:getFull,blink:blink,checkMatrix:checkMatrix};